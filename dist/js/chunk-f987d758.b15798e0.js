(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f987d758"],{"0a0d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"swd-index"},[o("div",{staticClass:"header"},[o("Decorate",{attrs:{icon:"ivu-icon ivu-icon-md-cube",title:"工作台",describe:"这里将展示你的个人项目，当然也包括协同项目。"}},["admin"==t.userInfo.role?o("div",{staticClass:"button-warp"},[o("Button",{attrs:{ghost:"",type:"primary",loading:t.refreshLoading,icon:"md-refresh"},on:{click:t.handleRefresh}},[t._v("重启所有服务")]),o("Button",{attrs:{ghost:"",type:"error",loading:t.powerLoading,icon:"md-power"},on:{click:t.handleCloseServer}},[t._v("关闭所有服务")])],1):t._e()])],1),o("div",{staticClass:"content"},[o("div",[t.projectData&&t.projectData.length?o("ul",t._l(t.projectData,(function(e,a){return o("li",{key:e.bid+a},[o("div",{staticClass:"item-header"},["1"==e.type?o("div",{staticClass:"left"},[o("span",{staticClass:"state"},[o("i",{style:{background:e.state.isServer?"#2d8cf0":"red"}}),o("span",[t._v(t._s(e.state.isServer?"服务已开启":"服务已关闭"))])]),o("span",{staticClass:"state auto"},[o("i",{style:{background:e.state.isAuto?"#2d8cf0":"red"}}),o("span",[t._v(t._s(e.state.isAuto?"部署已开启":"部署已暂停"))])])]):t._e(),"2"==e.type?o("div",{staticClass:"left"},[o("span",{staticClass:"state"},[o("i",{style:{background:e.state.isServer?"#2d8cf0":"red"}}),e.port?o("span",[t._v(t._s(e.state.isServer?"服务已开启":"服务已关闭"))]):o("span",[t._v("静态服务")])])]):t._e(),"3"==e.type||"4"==e.type?o("div",{staticClass:"left"},[o("span",{staticClass:"state"},[o("i",{style:{background:"#2d8cf0"}}),o("span",[t._v("远程部署（"+t._s("4"==e.type?"手动":"自动")+"）")])])]):t._e(),e.port&&"4"!==e.type?o("div",{staticClass:"right"},[o("Dropdown",{attrs:{trigger:"click"}},[o("Icon",{attrs:{type:"md-more",size:"18"}}),o("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[!e.port||"1"!=e.type&&"2"!=e.type?t._e():o("DropdownItem",{nativeOn:{click:function(a){return t.handleServer(e)}}},[t._v(" "+t._s(e.state.isServer?"关闭":"开启")+"运行服务 ")]),"1"===e.type||"3"===e.type?o("DropdownItem",{nativeOn:{click:function(a){return t.handleAuto(e)}}},[t._v(" "+t._s(e.state.isAuto?"关闭":"开启")+" Git 部署 ")]):t._e(),!e.port||"1"!==e.type&&"2"!==e.type?t._e():o("DropdownItem",{nativeOn:{click:function(a){return t.handleGzip(e)}}},[t._v(" "+t._s(e.state.isGzip?"关闭":"开启")+" Gzip 模式 ")]),!e.port||"1"!==e.type&&"2"!==e.type?t._e():o("DropdownItem",{nativeOn:{click:function(a){return t.handleHistory(e)}}},[t._v(" "+t._s("hash"===e.router?"切换至History模式":"切换至Hash模式")+" ")])],1)],1)],1):t._e()]),o("h2",{on:{click:function(a){return t.handleToUrl(e)}}},[t._v(" "+t._s(e.title)+" ")]),o("div",{staticClass:"content-box"},["1"==e.type?o("p",[o("Icon",{attrs:{type:"ios-code-working",size:"20"}}),o("span",[t._v(t._s(e.router)+" 模式")])],1):"3"==e.type||"4"==e.type?o("p",[o("Icon",{attrs:{type:"ios-code-working",size:"20"}}),o("span",[t._v(t._s(e.ssh.host))])],1):t._e(),o("p",[o("Icon",{attrs:{type:"ios-settings-outline",size:"18"}}),"1"==e.type||"2"==e.type?o("span",[t._v(" "+t._s(t.$store.state.typeMap[e.activeType])+t._s(e.port?"（"+e.port+"）":"")+" ")]):o("span",[t._v(" "+t._s(t.$store.state.typeMap[e.activeType])+" ")])],1),o("p",[o("Icon",{attrs:{type:"ios-time-outline",size:"18"}}),o("span",[t._v(t._s(e.updateTime))])],1)]),o("div",{staticClass:"description"},[t._v(" "+t._s(e.remark?e.remark:"暂无描述")+" ")]),o("div",{staticClass:"bottom-list"},[o("Tooltip",{staticClass:"border-r-no",attrs:{content:"删除",placement:"top"}},[o("Icon",{attrs:{type:"ios-trash-outline",size:"20"},on:{click:function(a){return t.handleModalDelete(e)}}})],1),o("Tooltip",{staticClass:"border-r-no",attrs:{content:"部署列表",placement:"top"}},[o("Icon",{attrs:{type:"ios-list",size:"26"},on:{click:function(a){return t.handleRouter("/commitList",e)}}})],1),o("Tooltip",{attrs:{content:"更新项目",placement:"top"}},["1"==e.type||"2"==e.type?o("Icon",{attrs:{type:"ios-create-outline",size:"20"},on:{click:function(a){return t.handleRouter("/create",e)}}}):"3"==e.type||"4"==e.type?o("Icon",{attrs:{type:"ios-create-outline",size:"20"},on:{click:function(a){return t.handleRouter("/createRemote",e)}}}):t._e()],1)],1)])})),0):o("div",{staticClass:"no-warp"},[o("img",{attrs:{src:a("5c25")}})]),o("div",{staticClass:"page"},[o("Page",{attrs:{"prev-text":"上一页","next-text":"下一页","show-elevator":"","show-total":"",total:t.total,"show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changeSizePage}})],1)])])])},s=[],n=(a("99af"),a("fb6a"),a("20d6")),i={components:{Decorate:n["a"]},data:function(){return{pageNo:1,pageSize:10,total:0,loading:!0,refreshLoading:!1,powerLoading:!1,projectData:[],userInfo:{}}},computed:{titlt:function(){return this.$store.state.title}},watch:{titlt:function(t){this.handleGetData(t)}},created:function(){var t=this;this.userInfo=this.$session.getItem("userInfo")||{},this.handleGetData(this.$store.state.title),this.$nextTick((function(){t.$mitt.emit("full-loading",!1)}))},methods:{handleGetData:function(t){var e=this;this.loading=!0;var a={title:t,userId:this.userInfo.bid,pageNo:this.pageNo,pageSize:this.pageSize};this.$request.get("/wd/deploy/get",{params:a}).then((function(t){e.loading=!1,200===t.data.code&&(e.total=t.data.total,e.projectData=t.data.data)})).catch((function(){e.loading=!1}))},changePage:function(t){this.pageNo=t,this.handleGetData()},changeSizePage:function(t){this.pageSize=t,this.handleGetData()},handleRefresh:function(){var t=this;this.$Modal.confirm({title:"系统提示",content:"<p>确定要重启所有项目服务吗？</p>",onOk:function(){t.refreshLoading=!0,t.$request.get("/wd/deploy/openAllServer").then((function(e){200===e.data.code?(t.$Message.success("所有服务已重启成功！"),t.refreshLoading=!1,t.handleGetData()):t.$Modal.error({title:"系统提示",content:"服务端口开启失败！"})}))}})},handleCloseServer:function(){var t=this;this.$Modal.confirm({title:"系统提示",content:"<p>确定要关闭所有项目服务吗？</p>",onOk:function(){t.powerLoading=!0,t.$request.get("/wd/deploy/closeAllServer").then((function(e){200===e.data.code?(t.powerLoading=!1,t.$Message.success("所有服务已关闭成功！"),t.handleGetData()):t.$Modal.error({title:"系统提示",content:"服务端口关闭失败！"})}))}})},handleServer:function(t){var e=this;t.state.isServer=!t.state.isServer,this.$request.post("/wd/deploy/updateInfo",t).then((function(a){200===a.data.code?(e.$Message.success("服务端口 ".concat(t.port," ").concat(t.state.isServer?"开启":"关闭","成功！")),e.handleGetData()):e.$Modal.error({title:"系统提示",content:"服务端口 ".concat(t.port," ").concat(t.state.isServer?"开启":"关闭","失败！")})}))},handleGzip:function(t){var e=this;t.state.isGzip=!t.state.isGzip,this.$request.post("/wd/deploy/updateInfo",t).then((function(t){200===t.data.code?(e.$Message.success("服务 gzip 模式开启成功！"),e.handleGetData()):e.$Modal.error({title:"系统提示",content:"服务 gzip 模式已关闭！"})}))},handleAuto:function(t){var e=this;t.state.isAuto=!t.state.isAuto,this.$request.post("/wd/deploy/updateInfo",t).then((function(t){200===t.data.code?(e.$Message.success("Git 自动部署已开启！"),e.handleGetData()):e.$Modal.error({title:"系统提示",content:"Git 自动部署关闭失败！"})}))},handleHistory:function(t){var e=this;t.router="history"==t.router?"hash":"history",this.$request.post("/wd/deploy/updateInfo",t).then((function(a){200===a.data.code?(e.$Message.success("路由已开启 ".concat(t.router," 模式！")),e.handleGetData()):e.$Modal.error({title:"系统提示",content:"路由 ".concat(t.router," 模式开启失败！")})}))},handleModalDelete:function(t){var e=this;this.$Modal.confirm({title:"操作提示",content:"<p'>删除后数据信息不可恢复，确定要删除吗？</p>",onOk:function(){e.$Message.loading({content:"正在删除中，请稍后...",duration:0}),e.$request.post("/wd/deploy/delete",t).then((function(t){e.$Message.destroy(),200===t.data.code?(e.$Message.success(t.data.message),e.handleGetData()):e.$Modal.error({title:"系统提示",content:t.data.message})}))}})},handleRouter:function(t,e){this.$router.push({path:t,query:{bid:e.bid,type:e.type}})},handleToUrl:function(t){var e=window.open();if(e.opener=null,"1"==t.type||"2"==t.type)if(t.port)e.location="".concat(window.location.protocol,"//").concat(window.location.hostname,":").concat(t.port);else{var a=t.www.indexOf("/")+1;t.www=t.www.slice(a,t.www.length),e.location="".concat(window.location.origin,"/").concat(t.www,"/index.html")}else"3"!=t.type&&"4"!=t.type||(e.location=t.href.protocol+t.href.host);e.target="_blank"}}},r=i,c=(a("487e"),a("2877")),l=Object(c["a"])(r,o,s,!1,null,"c63c1e24",null);e["default"]=l.exports},"487e":function(t,e,a){"use strict";a("d33f")},d33f:function(t,e,a){}}]);