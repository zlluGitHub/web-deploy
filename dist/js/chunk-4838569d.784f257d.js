(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4838569d"],{1369:function(t,e,a){},"1dde":function(t,e,a){var o=a("d039"),s=a("b622"),n=a("2d00"),r=s("species");t.exports=function(t){return n>=51||!o((function(){var e=[],a=e.constructor={};return a[r]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"20d6":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spots"},[a("span",{staticClass:"decorate",staticStyle:{background:"rgb(201, 27, 0)",width:"51px",height:"51px","margin-top":"-25.5px","margin-left":"-25.5px",top:"55.6675%",left:"5%"}}),a("span",{staticClass:"decorate",staticStyle:{background:"rgb(23, 90, 171)",width:"28px",height:"28px","margin-top":"-14px","margin-left":"-14px",top:"10.2246%",left:"15%"}}),a("span",{staticClass:"decorate",staticStyle:{background:"rgb(233, 34, 36)",width:"37px",height:"37px","margin-top":"-18.5px","margin-left":"-18.5px",top:"71.9133%",left:"25%"}}),a("span",{staticClass:"decorate",staticStyle:{background:"rgb(0, 62, 135)",width:"47px",height:"47px","margin-top":"-23.5px","margin-left":"-23.5px",top:"22.8839%",left:"35%"}}),a("span",{staticClass:"decorate",staticStyle:{background:"rgb(0, 135, 231)",width:"31px",height:"31px","margin-top":"-15.5px","margin-left":"-15.5px",top:"5.09172%",left:"45%"}}),a("span",{staticClass:"decorate",staticStyle:{background:"rgb(23, 90, 171)",width:"52px",height:"52px","margin-top":"-26px","margin-left":"-26px",top:"32.1525%",left:"55%"}}),a("span",{staticClass:"decorate",staticStyle:{background:"rgb(255, 86, 0)",width:"29px",height:"29px","margin-top":"-14.5px","margin-left":"-14.5px",top:"46.8035%",left:"65%"}}),a("span",{staticClass:"decorate",staticStyle:{width:"44px",height:"44px","margin-top":"-22px","margin-left":"-22px",top:"76.8537%",left:"75%"}}),a("span",{staticClass:"decorate",staticStyle:{background:"rgb(201, 27, 0)",width:"43px",height:"43px","margin-top":"-21.5px","margin-left":"-21.5px",top:"30.7088%",left:"85%"}}),a("span",{staticClass:"decorate",staticStyle:{width:"27px",height:"27px","margin-top":"-13.5px","margin-left":"-13.5px",top:"7.43497%",left:"95%"}}),a("div",{staticClass:"warp"},[a("div",{staticClass:"left"},[a("div",{staticClass:"logo"},[a("i",{class:t.icon})]),a("div",{staticClass:"info"},[a("h2",[t._v(t._s(t.title))]),a("p",[t._v(t._s(t.describe))])])]),t._t("default")],2)])},s=[],n={props:["icon","title","describe"]},r=n,i=(a("5c23"),a("2877")),c=Object(i["a"])(r,o,s,!1,null,"4c08b714",null);e["a"]=c.exports},"28ba":function(t,e,a){"use strict";a("e69a")},"2daf":function(t,e,a){"use strict";a("1369")},"5c23":function(t,e,a){"use strict";a("b7f7")},"5c74":function(t,e,a){"use strict";a("ed3d")},8418:function(t,e,a){"use strict";var o=a("c04e"),s=a("9bf2"),n=a("5c6c");t.exports=function(t,e,a){var r=o(e);r in t?s.f(t,r,n(0,a)):t[r]=a}},"99af":function(t,e,a){"use strict";var o=a("23e7"),s=a("d039"),n=a("e8b5"),r=a("861d"),i=a("7b0b"),c=a("50c4"),l=a("8418"),p=a("65f0"),d=a("1dde"),u=a("b622"),v=a("2d00"),f=u("isConcatSpreadable"),g=9007199254740991,_="Maximum allowed index exceeded",h=v>=51||!s((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),b=d("concat"),m=function(t){if(!r(t))return!1;var e=t[f];return void 0!==e?!!e:n(t)},w=!h||!b;o({target:"Array",proto:!0,forced:w},{concat:function(t){var e,a,o,s,n,r=i(this),d=p(r,0),u=0;for(e=-1,o=arguments.length;e<o;e++)if(n=-1===e?r:arguments[e],m(n)){if(s=c(n.length),u+s>g)throw TypeError(_);for(a=0;a<s;a++,u++)a in n&&l(d,u,n[a])}else{if(u>=g)throw TypeError(_);l(d,u++,n)}return d.length=u,d}})},a33d:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"log-box",attrs:{title:"部署日志",scrollable:"",transfer:!1,width:"70%","mask-closable":!1,"footer-hide":!0},model:{value:t.isLogModal,callback:function(e){t.isLogModal=e},expression:"isLogModal"}},[a("div",{ref:"logWarp",staticClass:"log-warp"},[a("ul",t._l(t.socketData,(function(e,o){return a("li",{key:o},[a("span",[t._v("【"+t._s(e.time)+" 】:")]),a("pre",{domProps:{innerHTML:t._s(e.message)}})])})),0)])])},s=[],n=a("20d6"),r=a("f971"),i={components:{Decorate:n["a"],DeployTip:r["a"]},data:function(){return{isLogModal:!1}},props:["socketData"],watch:{socketData:function(){this.isLogModal=!0;var t=this.$refs.logWarp;t.scrollHeight>t.clientHeight&&(t.scrollTop=t.scrollHeight)}}},c=i,l=(a("5c74"),a("2877")),p=Object(l["a"])(c,o,s,!1,null,"b2ba6ab0",null);e["a"]=p.exports},b7f7:function(t,e,a){},bf98:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"swd-details"},[a("div",{staticClass:"header"},[a("Decorate",{attrs:{icon:"ivu-icon ivu-icon-ios-paper-outline",title:"构建详情（"+t.projectData.title+"）",describe:"在这里可以预览的该项目的全部构建信息内容，可进行信息修改、二次部署等操作。"}},[a("div",{staticClass:"button-warp"},[a("Button",{attrs:{ghost:"",type:"primary"},on:{click:t.initReset}},[t._v("重新部署")]),a("Button",{attrs:{ghost:"",type:"success"},on:{click:t.installReset}},[t._v("依赖部署")]),a("Button",{attrs:{ghost:"",type:"info"},on:{click:t.buildReset}},[t._v("打包部署")]),a("Button",{attrs:{ghost:"",type:"warning"},on:{click:function(e){return t.handleRouter(0)}}},[t._v("修改信息")]),a("Button",{attrs:{ghost:"",type:"error"},on:{click:function(e){return t.handleRouter(1)}}},[t._v("转为静态部署")])],1)])],1),a("div",{staticClass:"breadcrumb"},[a("div",{staticClass:"warp"},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[a("Icon",{attrs:{type:"ios-home-outline",size:"18"}}),t._v(" 工作台 ")],1),a("BreadcrumbItem",[a("Icon",{attrs:{type:"ios-paper-outline",size:"18"}}),t._v(" "+t._s("构建详情（"+t.projectData.title+"）")+" ")],1)],1),a("div",{staticClass:"go-back",on:{click:function(e){return t.$router.go(-1)}}},[a("Icon",{attrs:{type:" fa fa-share-square-o",size:"15"}}),t._v(" "),a("span",[t._v("返回上一页")])],1)],1)]),a("div",{staticClass:"content"},[a("section",[a("div",{staticClass:"details-box"},[a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("项目名称：")]),a("p",[a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.handleToUrl(t.projectData)}}},[t._v(" "+t._s(t.projectData.title))]),a("i",{domProps:{innerHTML:t._s(t.svgIcon)}})])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("创建时间：")]),a("p",[t._v(t._s(t.projectData.time))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("部署Key：")]),a("p",[t._v(" "+t._s(t.projectData.bid)+" "),a("i",{staticClass:"fa fa-question-circle-o",style:{marginLeft:"6px",fontSize:"18px"}})])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("Git地址：")]),a("p",[a("a",{attrs:{href:t.projectData.git,target:"_blank"}},[t._v(t._s(t.projectData.git))]),a("i",{domProps:{innerHTML:t._s(t.svgIcon)}})])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("开始时间：")]),a("p",[t._v(t._s(t.projectData.startTime))])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("结束时间：")]),a("p",[t._v(t._s(t.projectData.endTime))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("部署时长：")]),a("p",[t._v(t._s(t.projectData.duration)+"秒")])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("服务状态：")]),a("p",[t._v(t._s(t.projectData.isServer?"已开启":"已关闭"))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("路由模式：")]),a("p",[t._v(t._s(t.projectData.router)+"模式")])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("部署方式：")]),a("p",[t._v(t._s("0"===t.projectData.isStatic?"自动部署":"静态部署"))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("构建者：")]),a("p",[t._v(t._s(t.projectData.userId?t.projectData.userId:"管理员"))])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("打包目录：")]),a("p",[t._v(t._s(t.projectData.dist))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("项目分支：")]),a("p",[t._v(t._s(t.projectData.branch))])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("部署端口：")]),a("p",[t._v(t._s(t.projectData.port))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("部署目录：")]),a("p",[t._v(t._s(t.projectData.www))])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("部署秘钥：")]),a("p",[t._v(t._s(t.projectData.key?t.projectData.key:"暂无秘钥"))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("打包命令：")]),a("p",[t._v(t._s(t.projectData.build))])]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("安装依赖：")]),a("p",[t._v(t._s(t.projectData.install))])])],1),a("Row",[a("Col",{attrs:{span:"12"}},[a("label",[t._v("代理地址：")]),a("div",t._l(t.projectData.proxy,(function(e,o){return a("p",{key:o},[e.target&&e.rewrite?[t._v(t._s(e.rewrite)+" "),a("Icon",{attrs:{type:"md-arrow-forward"}}),t._v(" "+t._s(e.target))]:[t._v("暂无任何代理")]],2)})),0)]),a("Col",{attrs:{span:"12"}},[a("label",[t._v("部署摘要：")]),a("p",[t._v(t._s(t.projectData.remark))])])],1)],1)])]),a("LogModal",{ref:"logModal",attrs:{socketData:t.socketData}})],1)},s=[],n=(a("99af"),a("20d6")),r=a("a33d"),i={components:{Decorate:n["a"],LogModal:r["a"]},data:function(){return{isLogModal:!1,socketData:[],current:0,status:"wait",projectData:{bid:"加载中...",branch:"加载中...",build:"加载中...",commitBid:"加载中...",deployState:"加载中...",dist:"加载中...",duration:"加载中...",git:"加载中...",install:"加载中...",isAuto:"加载中...",isServer:"加载中...",isStatic:"加载中...",isZip:"加载中...",key:"加载中...",port:"加载中...",proxy:[],remark:"加载中...",router:"加载中...",time:"加载中...",title:"加载中...",www:"加载中..."},stepContent:[{title:"",state:!0}]}},created:function(){this.svgIcon='<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>',this.getProjectData()},methods:{getProjectData:function(){var t=this;this.$request.get("/swd/deploy/get",{params:{bid:this.$route.query.bid}}).then((function(e){200===e.data.code&&(t.projectData=e.data.data[0],t.current=t.procedure(t.projectData.deployState),t.status=t.projectData.deployState.state?"process":"error")}))},initReset:function(){var t=this;this.$Modal.confirm({title:"系统提示",content:"<p>确定要重新部署该项目吗？</p>",onOk:function(){t.$Message.loading({content:"正在部署中，请稍后...",duration:0}),t.createSocketServer((function(){t.$refs.logModal.isLogModal=!0,t.$request.post("/swd/deploy/initReset",t.projectData).then((function(e){t.$Message.destroy(),200===e.data.code&&(t.$Modal.success({title:"系统提示",content:e.data.message}),t.getProjectData())}))}))},onCancel:function(){}})},buildReset:function(){var t=this;this.$Modal.confirm({title:"系统提示",content:"<p>确定要重新打包该项目吗？</p>",onOk:function(){t.$Message.loading({content:"正在部署中，请稍后...",duration:0}),t.createSocketServer((function(){t.$refs.logModal.isLogModal=!0,t.$request.post("/swd/deploy/relyBuild",t.projectData).then((function(e){t.$Message.destroy(),200===e.data.code&&(t.$Modal.success({title:"系统提示",content:e.data.message}),t.getProjectData())}))}))},onCancel:function(){}})},installReset:function(){var t=this;this.$Modal.confirm({title:"系统提示",content:"<p>确定要为该项目重新安装依赖文件吗？</p>",onOk:function(){t.$Message.loading({content:"正在部署中，请稍后...",duration:0}),t.createSocketServer((function(){t.$refs.logModal.isLogModal=!0,t.$request.post("/swd/deploy/relyInstall",t.projectData).then((function(e){t.$Message.destroy(),200===e.data.code&&(t.$Modal.success({title:"系统提示",content:e.data.message}),t.getProjectData())}))}))},onCancel:function(){}})},handleRouter:function(t){this.$router.push({path:"create",query:{bid:this.$route.query.bid,isStatic:t}})},handleToUrl:function(t){var e=window.open();e.opener=null,t.port?e.location="".concat(window.location.protocol,"//").concat(window.location.hostname,":").concat(t.port):e.location="".concat(window.location.origin,"/").concat(t.www),e.target="_blank"},procedure:function(t){return"state"===t.type?0:"clone"===t.type?1:"install"===t.type?2:"build"===t.type?3:"deploy"===t.type?4:"port"===t.type?6:0},createSocketServer:function(t){var e=this;this.$request.post("/swd/deploy/openSocket").then((function(a){a.data.result&&(e.socket=new WebSocket("ws://".concat(location.hostname,":8001")),e.socket.onopen=function(){e.socketData=[{message:"已连接到应用服务器，正在部署...",time:e.$dateTime()}],t()},e.socket.onmessage=function(t){e.socketData.push({message:t.data,time:e.$dateTime()})})}))}}},c=i,l=(a("2daf"),a("2877")),p=Object(l["a"])(c,o,s,!1,null,"0d18c5c0",null);e["default"]=p.exports},e69a:function(t,e,a){},ed3d:function(t,e,a){},f971:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tip-warp"},[a("h3",[a("Icon",{attrs:{type:"ios-help-circle-outline",size:"18"}}),a("span",{staticClass:"active"},[t._v("关联 Git 仓库")])],1),a("div",{staticClass:"content"},[a("div",[t._v("1、打开git：项目仓库 -> Settings -> Webhooks -> Add webhook")]),a("div",[t._v(" 2、在 "),a("span",{staticClass:"code"},[t._v("Target URL")]),t._v(" 中填入 "),a("span",{staticClass:"url"},[t._v(t._s(t.url)+"/swd/git/webhook")]),t._v(" 地址 ")]),t._m(0),t._m(1),t._m(2),a("div",[a("span",{staticStyle:{color:"red"}},[t._v("注意：")]),t._v("若项代码托管平台为GitHub时，在第 2 步中需要填入 "),a("span",{staticClass:"url"},[t._v(t._s(t.url)+"/swd/git/webhook?key="+t._s(t.key?t.key:"返回的key值"))]),t._v(" 地址。 ")])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" 3、 "),a("span",{staticClass:"code"},[t._v("POST Content Type")]),t._v(" 选择 "),a("span",{staticClass:"select"},[t._v("application/json")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" 4、 "),a("span",[t._v(" 在 "),a("span",{staticClass:"code"},[t._v("Secret")]),t._v(" 中填入部署成功后返回的 Key 值。 ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" 5、 "),a("span",{staticClass:"code"},[t._v("Trigger On")]),t._v("选择 "),a("span",{staticClass:"select"},[t._v("Push Events")])])}],n={data:function(){return{key:"",url:""}},mounted:function(){this.url=window.location.origin},methods:{handleShell:function(){this.$event.emit("isShell",!0)}}},r=n,i=(a("28ba"),a("2877")),c=Object(i["a"])(r,o,s,!1,null,"61335340",null);e["a"]=c.exports}}]);