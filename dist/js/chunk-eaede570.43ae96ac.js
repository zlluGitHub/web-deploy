(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eaede570"],{"1efd":function(t,e,a){},"939a":function(t,e,a){"use strict";a("1efd")},dab6:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-index"},[a("div",{staticClass:"header"},[a("Decorate",{attrs:{icon:"ivu-icon ivu-icon-ios-people",title:"用户管理",describe:"这里将展示所有用户信息，管理员可进行更改。"}})],1),a("div",{staticClass:"content"},[a("div",{staticClass:"query-warp"},[a("Form",{attrs:{inline:"","label-position":"left","label-width":70},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{label:"邮箱地址"}},[a("Input",{attrs:{type:"text",placeholder:"请输入邮箱地址"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),a("FormItem",{staticClass:"button-warp"},[a("Button",{on:{click:t.handleReset}},[t._v("重置")]),a("Button",{attrs:{type:"primary"},on:{click:t.handleGetData}},[t._v("检索")])],1)],1),a("Button",{attrs:{type:"primary"},on:{click:t.handleEdit}},[t._v("添加用户")])],1),a("div",{staticClass:"table-warp"},[a("Table",{attrs:{columns:t.columns,data:t.tableData,border:""},scopedSlots:t._u([{key:"name",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.email))]),n.name?a("span",[t._v("（"+t._s(n.name)+"）")]):t._e()]}},{key:"roles",fn:function(e){var n=e.row;return[n.role?a("span",[t._v(t._s(n.role))]):a("span",[t._v("管理员")])]}},{key:"state",fn:function(e){var n=e.row;return[a("i-switch",{staticStyle:{"margin-right":"10px"},attrs:{size:"small","true-value":!0,"false-value":!1,disabled:t.userInfo.bid==n.bid},on:{"on-change":function(e){return t.handleOnSwitch(n)}},model:{value:n.state,callback:function(e){t.$set(n,"state",e)},expression:"row.state"}}),a("span",{staticClass:"state"},[t._v(t._s(n.state?"开启":"禁用"))])]}},{key:"action",fn:function(e){var n=e.row;return[a("Button",{staticStyle:{"margin-right":"10px"},on:{click:function(e){return t.handleEdit(n)}}},[t._v("编辑 ")]),a("Button",{on:{click:function(e){return t.handleDelete(n)}}},[t._v("删除 ")])]}}])})],1),a("div",{staticClass:"page"},[a("Page",{attrs:{"prev-text":"上一页","next-text":"下一页","show-elevator":"","show-total":"",total:t.total,"show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changeSizePage}})],1)]),a("CreateUpdate",{ref:"createUpdate"})],1)},s=[],i=(a("e9c4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"create-update",attrs:{transfer:!1,width:"600",title:t.formData.bid?"用户编辑":"添加用户"},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[a("div",{staticClass:"content"},[a("div",{staticClass:"inner-warp"},[a("Form",{ref:"formRef",attrs:{model:t.formData,rules:t.formRule,"label-position":"top"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{label:"昵称（可不填）"}},[a("Input",{attrs:{size:"large",maxlength:"15","show-word-limit":"",placeholder:"请输入用户名"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入用户邮箱",size:"large"},model:{value:t.formData.email,callback:function(e){t.$set(t.formData,"email",e)},expression:"formData.email"}})],1),a("FormItem",{attrs:{label:"密码",prop:"password"}},[a("Input",{attrs:{placeholder:"请输入用户密码",size:"large"},model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}})],1),a("FormItem",{attrs:{label:"角色",prop:"role"}},[a("Select",{attrs:{size:"large"},model:{value:t.formData.role,callback:function(e){t.$set(t.formData,"role",e)},expression:"formData.role"}},t._l(t.roleList,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1)]),a("div",{staticClass:"button-warp",attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:t.handleClose}},[t._v("重置")]),a("Button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确认")])],1)])}),o=[],r=a("ed08"),l={name:"CreateUpdate",data:function(){return{isOpen:!1,roleList:[],formData:{},formRule:{email:[{required:!0,type:"email",message:"邮箱格式不正确，请重新输入！",trigger:"blur"}],password:[{required:!0,message:"用户密码不得为空！",trigger:"blur"}],name:[{required:!0,message:"用户姓名不得为空！",trigger:"blur"}],role:[{required:!0,message:"请选择角色！",trigger:"blur"}]}}},created:function(){var t=[],e=this.$store.state.roles;for(var a in this.$store.state.roles)t.push({label:e[a],value:a});this.roleList=t},methods:{setData:function(t){this.isOpen=!0,t.email||(t.password=Object(r["d"])(6),t.role="general"),this.formData=t},handleSubmit:function(){var t=this;this.$refs.formRef.validate((function(e){if(e){t.loading=!0;var a="/wd/user/register";t.formData.bid?a="/wd/user/update":t.formData.oauth="add",t.$request.post(a,t.formData).then((function(e){t.loading=!1,200==e.data.code&&(t.$Message.success("操作成功！"),t.$parent.handleGetData(),t.isOpen=!1,t.formData={})})).catch((function(){t.loading=!1}))}}))},handleClose:function(){this.formData={},this.$refs.formRef.resetFields()}}},c=l,u=a("2877"),d=Object(u["a"])(c,i,o,!1,null,null,null),f=d.exports,m=a("20d6"),h={components:{Decorate:m["a"],CreateUpdate:f},data:function(){return{pageNo:1,pageSize:10,total:0,loading:!0,userInfo:{},email:"",columns:[{title:"用户",slot:"name"},{title:"角色",slot:"roles"},{title:"状态",slot:"state"},{title:"加入方式",key:"oauth"},{title:"创建时间",key:"createTime"},{title:"操作",width:200,slot:"action"}],tableData:[]}},watch:{titlt:function(t){this.handleGetData(t)}},created:function(){var t=this;this.userInfo=this.$session.getItem("userInfo")||{},this.handleGetData(),this.$nextTick((function(){t.$mitt.emit("full-loading",!1)}))},methods:{handleGetData:function(){var t=this;this.loading=!0;var e={email:this.email,pageNo:this.pageNo,pageSize:this.pageSize};this.$request.get("/wd/user/get",{params:e}).then((function(e){t.loading=!1,200===e.data.code&&(t.total=e.data.total,t.tableData=e.data.data)})).catch((function(){t.loading=!1}))},changePage:function(t){this.pageNo=t,this.handleGetData()},changeSizePage:function(t){this.pageSize=t,this.handleGetData()},handleOnSwitch:function(t){var e=this;this.loading=!0,this.$request.post("/wd/user/update",{bid:t.bid,state:t.state}).then((function(t){e.loading=!1,200==t.data.code&&e.handleGetData()})).catch((function(){e.loading=!1}))},handleEdit:function(t){this.$refs.createUpdate.setData(JSON.parse(JSON.stringify(t||{})))},handleDelete:function(t){var e=this;this.$Modal.confirm({title:"操作提示",content:"<p'>删除后用户信息不可恢复，确定要删除吗？</p>",onOk:function(){e.$Message.loading({content:"正在删除中，请稍后...",duration:0}),e.$request.post("/wd/user/delete",{bid:t.bid}).then((function(t){e.$Message.destroy(),200===t.data.code&&(e.$Message.success("删除成功！"),e.handleGetData())}))}})},handleReset:function(){this.email="",this.pageNo=1,this.pageSize=10,this.handleGetData()}}},p=h,g=(a("939a"),Object(u["a"])(p,n,s,!1,null,"de7c6002",null));e["default"]=g.exports}}]);